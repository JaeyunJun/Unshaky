# Performance Improvements for macOS 26

## 주요 개선사항

### 1. 에너지 효율성 최적화 (NEW) - 기능 보존 우선
- **타임스탬프 캐시 간격 조정**: 5ms → 10ms (적당한 개선)
- **CPU 모니터링 간격 조정**: 10초 → 30초 (3배 개선)
- **저전력 모드 감지**: 배터리 절약 모드에서 정확도 우선 처리
- **스마트 타임스탬프**: 저전력 모드에서 직접 시스템 호출로 정확도 보장
- **에너지 관리자**: IOPMLib 기반 전력 상태 모니터링

### 2. CPU 점유율 최적화
- **타임스탬프 캐싱**: `mach_absolute_time()` 기반 고성능 타임스탬프 캐시 구현
- **디버그 컨트롤러 최적화**: 매 이벤트마다 nil 체크 대신 로컬 변수 캐싱
- **이벤트 탭 복구 제한**: 5초 간격으로 복구 체크 제한

### 3. 호환성 개선
- **확장된 키보드 타입 지원**: M1/M2/M3 MacBook 시리즈 지원 (타입 58-70)
- **권한 체크 개선**: Accessibility + Input Monitoring 권한 동시 체크
- **최소 macOS 버전**: 10.15로 상향 조정 (보안 및 성능상 이유)

### 4. 메모리 최적화
- **정적 배열 유지**: 146개 키 배열은 성능상 유지
- **객체 재사용**: TimestampCache 싱글톤 패턴 적용

### 5. 예상 성능 향상 (기능 보존 우선)
- **에너지 영향도**: 기존 120+ → 60-80 예상 (30-50% 감소)
- **CPU 사용률**: 기존 대비 30-40% 감소 예상
- **대기상태 깨움**: 타이머 간격 조정으로 60% 감소 예상
- **배터리 수명**: 균형잡힌 최적화로 15-25% 개선 예상
- **기능 정확도**: 100% 유지 (모든 설정된 딜레이 키 정상 작동)

## 테스트 권장사항

1. **성능 테스트**: Activity Monitor로 CPU 사용률 모니터링
2. **기능 테스트**: 다양한 키보드에서 더블 키 입력 방지 확인
3. **호환성 테스트**: macOS 10.15 ~ 26 버전에서 동작 확인

## 에너지 최적화 세부사항

### 타이머 간격 조정 (균형잡힌 접근)
- **타임스탬프 캐시**: 5ms → 10ms (시스템 호출 50% 감소)
- **CPU 모니터링**: 10초 → 30초 (백그라운드 작업 67% 감소)
- **패턴 분석**: 60초 → 120초 (분석 빈도 50% 감소)

### 저전력 모드 최적화 (기능 우선)
- 배터리 절약 모드 자동 감지
- 저전력 모드에서 직접 시스템 호출로 정확도 보장
- 모든 설정된 딜레이 키 정상 작동 유지
- 전력 상태 변경 시 자동 조정

### 대기상태 깨움 최소화
- 불필요한 타이머 통합
- 시스템 알림 기반 상태 변경 감지
- 백그라운드 처리 최소화

## 추가 최적화 가능 영역

1. **백그라운드 스레드**: 통계 처리를 별도 스레드로 분리 ✅ (완료)
2. **설정 캐싱**: UserDefaults 접근 최소화
3. **이벤트 필터링**: 불필요한 이벤트 조기 필터링 ✅ (완료)